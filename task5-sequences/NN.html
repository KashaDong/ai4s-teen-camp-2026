<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>神经网络与非线性递推数列</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/plotly.js/2.18.2/plotly.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f8f9fa;
        }
        h1, h2 {
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }
        .container {
            background: white;
            padding: 25px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
        .comparison {
            display: flex;
            gap: 20px;
            margin-top: 20px;
        }
        .model {
            flex: 1;
            padding: 15px;
            border-radius: 8px;
            background: #f8f9fa;
        }
        .linear-model {
            border-left: 4px solid #e74c3c;
        }
        .neural-network {
            border-left: 4px solid #27ae60;
        }
        .neural-diagram {
            text-align: center;
            margin: 20px 0;
        }
        .layer {
            display: inline-block;
            vertical-align: middle;
            margin: 0 20px;
        }
        .neuron {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 10px auto;
            font-weight: bold;
            color: white;
        }
        .input-neuron {
            background: #3498db;
        }
        .hidden-neuron {
            background: #9b59b6;
        }
        .output-neuron {
            background: #e74c3c;
        }
        .function-example {
            background: #e8f4f8;
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
            border-left: 4px solid #3498db;
        }
        .plot-container {
            height: 400px;
            margin: 20px 0;
        }
        .advantage-list {
            list-style-type: none;
            padding-left: 0;
        }
        .advantage-list li {
            margin-bottom: 10px;
            padding-left: 30px;
            position: relative;
        }
        .advantage-list li:before {
            content: "✓";
            position: absolute;
            left: 0;
            color: #27ae60;
            font-weight: bold;
        }
    </style>
</head>
<body>

    <h1>神经网络如何处理非线性递推数列</h1>

    <div class="container">
        <h2>问题背景</h2>
        <p>在递推数列研究中，我们经常遇到形如 $a_{n+3} = f(a_n, a_{n+1})$ 的关系。当 $f$ 是线性函数时，简单的线性回归就能解决。但当 $f$ 是非线性函数时，我们需要更强大的工具——神经网络。</p>
        
        <div class="function-example">
            <h3>非线性递推关系示例：</h3>
            <p>$$a_{n+3} = \sin(a_{n+1}) + \ln(|a_n| + 1) + \frac{a_{n+1} \cdot a_n}{a_{n+1}^2 + a_n^2 + 1}$$</p>
            <p>这种复杂的非线性组合无法用简单的线性模型 $a_{n+3} = p \cdot a_{n+1} - q \cdot a_n$ 来准确表示。</p>
        </div>
    </div>

    <div class="container">
        <h2>模型对比</h2>
        <div class="comparison">
            <div class="model linear-model">
                <h3>线性回归模型</h3>
                <div class="neural-diagram">
                    <div class="layer">
                        <div class="neuron input-neuron">$a_n$</div>
                        <div class="neuron input-neuron">$a_{n+1}$</div>
                    </div>
                    <div style="display:inline-block; margin: 0 20px; font-size: 24px;">→</div>
                    <div class="layer">
                        <div class="neuron output-neuron">$a_{n+3}$</div>
                    </div>
                </div>
                <p><strong>数学形式：</strong> $a_{n+3} = p \cdot a_{n+1} - q \cdot a_n$</p>
                <p><strong>局限性：</strong> 只能表示输入变量的线性组合，无法捕捉复杂的非线性关系。</p>
            </div>
            
            <div class="model neural-network">
                <h3>神经网络模型</h3>
                <div class="neural-diagram">
                    <div class="layer">
                        <div class="neuron input-neuron">$a_n$</div>
                        <div class="neuron input-neuron">$a_{n+1}$</div>
                    </div>
                    <div style="display:inline-block; margin: 0 20px; font-size: 24px;">→</div>
                    <div class="layer">
                        <div class="neuron hidden-neuron">$h_1$</div>
                        <div class="neuron hidden-neuron">$h_2$</div>
                        <div class="neuron hidden-neuron">$h_3$</div>
                    </div>
                    <div style="display:inline-block; margin: 0 20px; font-size: 24px;">→</div>
                    <div class="layer">
                        <div class="neuron output-neuron">$a_{n+3}$</div>
                    </div>
                </div>
                <p><strong>数学形式：</strong> </p>
                <p>$h_1 = \sigma(w_{11}a_n + w_{12}a_{n+1} + b_1)$</p>
                <p>$h_2 = \sigma(w_{21}a_n + w_{22}a_{n+1} + b_2)$</p>
                <p>$h_3 = \sigma(w_{31}a_n + w_{32}a_{n+1} + b_3)$</p>
                <p>$a_{n+3} = v_1 h_1 + v_2 h_2 + v_3 h_3 + c$</p>
                <p>其中 $\sigma$ 是非线性激活函数。</p>
            </div>
        </div>
    </div>

    <div class="container">
        <h2>神经网络如何处理非线性关系</h2>
        
        <h3>1. 引入非线性激活函数</h3>
        <p>神经网络通过在隐藏层使用非线性激活函数（如 tanh, ReLU, sigmoid）来引入非线性变换能力：</p>
        <ul>
            <li><strong>tanh(x)</strong>：将输入压缩到(-1,1)区间，适合学习周期性模式</li>
            <li><strong>ReLU(x)</strong>：max(0,x)，简单高效，适合现代深度学习</li>
            <li><strong>sigmoid(x)</strong>：将输入压缩到(0,1)区间，适合学习概率和饱和行为</li>
        </ul>
        
        <h3>2. 函数逼近原理</h3>
        <p>根据<strong>通用逼近定理</strong>，具有单个隐藏层的前馈神经网络，只要使用非线性激活函数且隐藏层足够宽，就可以以任意精度逼近任何连续函数。</p>
        
        <h3>3. 处理复杂非线性关系的步骤</h3>
        <p>对于非线性递推关系 $a_{n+3} = \sin(a_{n+1}) + \ln(|a_n| + 1)$，神经网络会：</p>
        <ol>
            <li>将输入 $[a_n, a_{n+1}]$ 通过权重矩阵映射到隐藏层</li>
            <li>在隐藏层中，不同的神经元会学习不同的非线性变换</li>
            <li>某些神经元会学习近似正弦函数的行为</li>
            <li>某些神经元会学习近似对数函数的行为</li>
            <li>输出层将这些部分结果组合起来，形成最终预测</li>
        </ol>
        
        <div class="plot-container" id="functionPlot"></div>
    </div>

    <div class="container">
        <h2>神经网络的数学优势</h2>
        
        <h3>线性模型的局限性</h3>
        <p>线性模型 $f(x,y) = px + qy$ 只能表示一个平面，无法表示复杂的曲面。</p>
        
        <h3>神经网络的表达能力</h3>
        <p>神经网络 $f(x,y) = \sum_{i=1}^k v_i \sigma(w_{i1}x + w_{i2}y + b_i)$ 可以表示：</p>
        <ul class="advantage-list">
            <li>任意复杂的连续函数</li>
            <li>多个不同模式的组合</li>
            <li>局部特征和全局特征的混合</li>
            <li>高度非线性的交互作用</li>
        </ul>
        
        <h3>实际应用中的优势</h3>
        <p>当数据点明显不分布在一个平面上，而是呈现出弯曲、震荡或其他复杂模式时，神经网络能够：</p>
        <ul>
            <li>自动学习数据中的复杂模式，无需人工设计特征</li>
            <li>适应多种不同类型的非线性关系</li>
            <li>通过增加网络深度和宽度提高逼近精度</li>
        </ul>
    </div>

    <div class="container">
        <h2>总结</h2>
        <p>你的线性回归模型是一个特殊形式的神经网络——没有隐藏层的单层感知机。它适合处理线性关系，但在面对复杂的非线性递推关系时，需要引入隐藏层和非线性激活函数来增强模型的表达能力。</p>
        <p>神经网络通过组合多个简单非线性函数来构建复杂函数，这种"非线性基函数的线性组合"使其能够处理各种复杂的数学关系，包括那些无法用简单公式表示的模式。</p>
    </div>

<script>
    // 绘制函数图像展示线性与非线性区别
    function createFunctionPlot() {
        // 生成数据
        let x = [];
        let linear = [];
        let nonlinear = [];
        
        for (let i = 0; i <= 100; i++) {
            let val = i / 10;
            x.push(val);
            linear.push(0.5 * val);  // 线性函数
            nonlinear.push(Math.sin(val) + 0.1 * val * val);  // 非线性函数
        }
        
        const trace1 = {
            x: x,
            y: linear,
            mode: 'lines',
            name: '线性函数: f(x) = 0.5x',
            line: { color: '#e74c3c', width: 3 }
        };
        
        const trace2 = {
            x: x,
            y: nonlinear,
            mode: 'lines',
            name: '非线性函数: f(x) = sin(x) + 0.1x²',
            line: { color: '#27ae60', width: 3 }
        };
        
        const layout = {
            title: '线性函数与非线性函数对比',
            xaxis: { title: 'x' },
            yaxis: { title: 'f(x)' },
            showlegend: true,
            height: 400
        };
        
        Plotly.newPlot('functionPlot', [trace1, trace2], layout);
    }
    
    // 页面加载完成后创建图表
    document.addEventListener('DOMContentLoaded', function() {
        createFunctionPlot();
        
        // 渲染数学公式
        if (window.MathJax) {
            MathJax.typeset();
        }
    });
</script>

<!-- 加载MathJax用于数学公式渲染 -->
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.bootcdn.net/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js"></script>
<script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']]
        }
    };
</script>
<footer style="text-align: center; margin-top: 40px; padding: 20px; border-top: 1px solid #e9ecef; color: #6c757d; font-size: 14px; line-height: 1.5;">
    <p style="margin: 5px 0;">© 2025 付佳兴、马衍龙、郑子杰及AI4S TEEN CAMP组委会</p>
    <p style="margin: 5px 0; font-size: 13px;">本教学材料仅供课堂教学与学术交流使用，未经书面许可，不得用于任何商业用途。</p>
</footer>
</body>
</html>